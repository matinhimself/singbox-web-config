{{define "config-backups.html"}}
<div class="backups-container">
    <div class="backup-actions" style="margin-bottom: 1rem;">
        <button class="button button-primary" onclick="showBackupForm()">+ Create Backup</button>
        <a href="/api/config/export" class="button" download>Export Current Config</a>
    </div>

    <div id="backup-form" style="display: none; margin-bottom: 1rem; padding: 1rem; border: 1px solid #ddd; border-radius: 4px; background: #f9f9f9;">
        <h3 style="margin-top: 0;">Create Manual Backup</h3>
        <form hx-post="/api/config/create-backup" hx-target="#config-backups">
            <div style="margin-bottom: 0.5rem;">
                <label for="backup-name" style="display: block; margin-bottom: 0.25rem;">Name:</label>
                <input type="text" id="backup-name" name="name" placeholder="e.g., Before migration" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div style="margin-bottom: 0.5rem;">
                <label for="backup-desc" style="display: block; margin-bottom: 0.25rem;">Description (optional):</label>
                <input type="text" id="backup-desc" name="description" placeholder="e.g., Backup before major changes" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div style="display: flex; gap: 0.5rem;">
                <button type="submit" class="button button-primary">Create</button>
                <button type="button" class="button" onclick="hideBackupForm()">Cancel</button>
            </div>
        </form>
    </div>

    {{if .Backups}}
    <div class="backups-list">
        {{range .Backups}}
        <div class="backup-item" style="padding: 1rem; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px; background: white;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                <div style="flex: 1;">
                    <div style="font-weight: bold; margin-bottom: 0.25rem;">{{.Metadata.Name}}</div>
                    {{if .Metadata.Description}}
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 0.25rem;">{{.Metadata.Description}}</div>
                    {{end}}
                    <div style="font-size: 0.85em; color: #999;">
                        {{.Metadata.Timestamp.Format "2006-01-02 15:04:05"}}
                        {{if .Metadata.Version}} Â· Version {{.Metadata.Version}}{{end}}
                    </div>
                    <div style="font-size: 0.8em; color: #aaa; margin-top: 0.25rem;">{{.Filename}}</div>
                </div>
                <form hx-post="/api/config/restore" hx-target="#config-backups" hx-confirm="Are you sure you want to restore this backup? Current config will be backed up first.">
                    <input type="hidden" name="backup" value="{{.Filename}}">
                    <button type="submit" class="button button-small">Restore</button>
                </form>
            </div>
        </div>
        {{end}}
    </div>
    {{else}}
    <p class="empty-state">No backups available. Create your first backup above!</p>
    {{end}}
</div>

<script>
function showBackupForm() {
    document.getElementById('backup-form').style.display = 'block';
}
function hideBackupForm() {
    document.getElementById('backup-form').style.display = 'none';
    document.getElementById('backup-name').value = '';
    document.getElementById('backup-desc').value = '';
}
</script>
{{end}}
