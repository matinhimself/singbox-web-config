{{define "rule-action-list.html"}}
{{if .RuleActions}}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {{range $index, $action := .RuleActions}}
        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg shadow-sm overflow-hidden">
            <div class="p-4 border-b border-gray-200 dark:border-gray-600 flex justify-between items-center">
                <div>
                    <h3 class="font-bold text-lg text-gray-800 dark:text-gray-200">Action {{add $index 1}}</h3>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                        {{if eq .Type "route"}} bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 {{end}}
                        {{if eq .Type "reject"}} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300 {{end}}
                        {{if eq .Type "sniff"}} bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300 {{end}}
                        {{if eq .Type "resolve"}} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 {{end}}
                        {{if eq .Type "route-options"}} bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300 {{end}}
                        {{if eq .Type "hijack-dns"}} bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300 {{end}}
                    ">
                        {{.Type}}
                    </span>
                </div>
                <div class="flex items-center space-x-2">
                    <button class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded text-sm"
                            hx-get="/api/rule-actions/form?index={{$index}}"
                            hx-target="body"
                            hx-swap="beforeend">
                        Edit
                    </button>
                    <button class="bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded text-sm"
                            hx-delete="/api/rule-actions/delete?index={{$index}}"
                            hx-target="#rule-actions-list"
                            hx-swap="innerHTML"
                            hx-confirm="Are you sure you want to delete this rule action?">
                        Delete
                    </button>
                </div>
            </div>

            <div class="p-4 text-sm text-gray-700 dark:text-gray-300 space-y-2">
                {{if eq .Type "route"}}
                    <p><strong>Outbound:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.Outbound}}</code></p>
                {{else if eq .Type "sniff"}}
                    {{if .Sniffer}}<p><strong>Sniffers:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{range $i, $s := .Sniffer}}{{if $i}}, {{end}}{{$s}}{{end}}</code></p>{{end}}
                    {{if .Timeout}}<p><strong>Timeout:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.Timeout}}ms</code></p>{{end}}
                {{else if eq .Type "resolve"}}
                    {{if .Server}}<p><strong>DNS Server:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.Server}}</code></p>{{end}}
                    {{if .Strategy}}<p><strong>Strategy:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.Strategy}}</code></p>{{end}}
                {{else if eq .Type "reject"}}
                    {{if .Method}}<p><strong>Method:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.Method}}</code></p>{{end}}
                {{else if eq .Type "route-options"}}
                    {{if .Outbound}}<p><strong>Outbound:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.Outbound}}</code></p>{{end}}
                    {{if .OverrideAddress}}<p><strong>Override Address:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.OverrideAddress}}</code></p>{{end}}
                    {{if .OverridePort}}<p><strong>Override Port:</strong> <code class="bg-gray-200 dark:bg-gray-600 p-1 rounded">{{.OverridePort}}</code></p>{{end}}
                {{end}}
            </div>

            <div class="p-4 bg-gray-100 dark:bg-gray-800">
                <details>
                    <summary class="cursor-pointer text-sm font-medium text-gray-600 dark:text-gray-400">View JSON</summary>
                    <pre class="mt-2 p-2 bg-white dark:bg-gray-900 rounded-md text-xs">{{marshal .Config}}</pre>
                </details>
            </div>
        </div>
        {{end}}
    </div>
    <script>
        document.getElementById('rule-action-count').textContent = '{{len .RuleActions}} rule action(s)';
    </script>
{{else}}
    <div class="text-center py-12">
        <p class="text-gray-500 dark:text-gray-400">No rule actions configured yet.</p>
        <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Click "Add Rule Action" to create your first rule action configuration.</p>
    </div>
    <script>
        document.getElementById('rule-action-count').textContent = '0 rule actions';
    </script>
{{end}}
{{end}}
